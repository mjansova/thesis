\clearpage

\setcounter{secnumdepth}{4}
\chapterwithnum{The CMS experiment at the LHC}
\setcounter{secnumdepth}{5}

Among others, one very important possibility how to study matter is at collider experiments. In Section~\ref{sec:LHC} the largest existing collider, the LHC, and its experiments are introduced. In the next Section~\ref{sec:CMS} the CMS detector, in which context this thesis is performed, is described. Then in Section~\ref{sec:objects}, object reconstruction techniques of the CMS data are introduced. A special interest is put on the topics whose knowledge is needed or which are further developed in following chapters of this thesis.

\section{The Large Hadron Collider~\label{sec:LHC}}

The Large Hadron Collider~(LHC)~\cite{CERN-Brochure-2017-002-Eng, Evans:2008zzb} is a particle accelerator with a circumference of 27~km, which is a part of the CERN accelerator complex~\cite{Mobs:2225847} located near Geneva, Switzerland. The LHC project was approved in 1994 and designed to provide mainly collisions of protons. Part of the LHC operation time is also dedicated to collisions of heavy nuclei, but in this thesis only the proton collisions will be described.

A schematic view of the CERN accelerator complex with its main experiments is presented in Fig.~\ref{fig:figures/CCC-v2016}~\cite{Mobs:2225847}. At the beginning of the acceleration process the protons are obtained by stripping electrons from the hydrogen atoms. Protons are then pre-accelerated through a chain of accelerators: Linac2, PS Booster, Proton Synchrotron~(PS) and Super Proton Synchrotron~(SPS). The proton beams accelerated to 450~GeV are injected from SPS into the LHC~(both clockwise and anti-clockwise), where the beams are further shaped and accelerated with eight RF~(radio-frequency) cavities currently up to 6.5~TeV. The LHC is equipped with around ten thousand magnets, mainly dipoles and quadrupoles, to bend and focus the beams. There is a vacuum in the LHC tube to avoid collisions of particles with gas, the vacuum being also used for isolation of cryomagnets and helium distribution line.

    \insertFigure{figures/CCC-v2016} % Filename = label
                 {0.9}       % Width, in fraction of the whole page width
                 { The CERN accelerator complex~\cite{Mobs:2225847}. }

The proton beams are not homogenous but are consisted of trains of bunches, each bunch containing around 100 billions of protons. Bunches within a given train are spaced by 25~ns. Time gaps between tow different trains are longer. The LHC uses several beam structures, which are specified by the filling scheme. An example of a beam structure is shown in Fig.~\ref{fig:figures/beamStructure}. The proton beams are accelerated in separate pipes and then collided against each other at four interaction points~(IP). The LHC operations are divided into two eras, Run~I and Run~2. The Run~I started in 2008 and ended in 2013. During this era the center-of-mass energy of the collisions was first 7~TeV and then increased in 2012 to 8~TeV and the beam structure allowed collisions every 50~ns. The Run~II started in 2015 and is still ongoing. In the Run~II the collision center-of-mass energy increased to 13~TeV and the time between collisions was reduced to 25~ns.

    \insertFigure{figures/beamStructure} % Filename = label
                 {0.9}       % Width, in fraction of the whole page width
                 { An example of beam and train structure. The beam pipes are shown in red and violet and the beams are drawn in green. }

The bunches of protons collide at four IPs, at which four main experiments were installed. The two general-purpose detectors, which were designed to cover a wide range of physics, are ATLAS (standing for ``A Toroidal  LHC ApparatuS'')~\cite{Aad:2008zzm} and CMS (standing for ``Compact Muon Solenoid'')~\cite{Chatrchyan:2008aa}. The other two main experiments are ALICE (standing for ``A Large Ion Collider Experiment'')~\cite{Aamodt:2008zz}, which focuses on the analysis of heavy-ion collisions and the LHCb (standing for ``Large Hadron Collider beauty'')~\cite{Alves:2008zz} specialized in the physics of the b-quark. There are also three smaller experiments along the LHC, one of them is TOTEM~\cite{Anelli:2008zza} which is close to CMS and its principal goal is to measure the total cross section of protons at LHC. LHCf~\cite{Adriani:2008zz}, which is located near to the ATLAS experiment, studies particles moving very close to the proton beams. Finally MoEDAL~\cite{Acharya:2014nyr}, which is close to LHCb, focuses on the search of hypothetical particles, e.g. magnetic monopoles.

One of the main motivations for the LHC and its experiments was the search for the Higgs boson, which was discovered in 2012. A second important topic of research is search for new particles and more generally for evidence of physics beyond the Standard Model, motivated among others by cosmological observations and desire for unification of known forces. Additionally, the main focus of the  heavy-ion collisions is state called ``quark-gluon plasma'', which existed at the early Universe.

\newpage

\section{The Compact Muon Solenoid detector~\label{sec:CMS}}

The Compact Muon Solenoid~(CMS)~\cite{Chatrchyan:2008aa, CMSproposal} is a multipurpose detector of a length of 28.7~m, a diameter of 15~m and a weight of 14~t,  which is located at the interaction point 5~\cite{Chatrchyan:2008aa}. The designed properties of the CMS  detector were to have good muon identification and resolution, to have good charged-particle momentum and resolution as well as high efficiency in reconstruction of charged-particle tracks. Further it was required to have good electromagnetic energy, missing transverse energy~(MET) and dijet mass resolution. One of the important requirements was also high efficiency in offline tagging of tau particles and jets originating from b-quarks. These conditions have to be fulfilled in the LHC environment, with bunch crossing~(BX) every 25~ns, where every bunch crossing leads to tens of inelastic interactions on top of the interaction of the interest, resulting in thousands of charged particles in the CMS detector every 25~ns. Because of this large radiation, the detectors and front-end electronics have to be radiation-hard.

To achieve given requirements, the CMS was built in layers around large solenoidal magnet, with endcaps at each side. Inside the magnet from the interaction points outwards, there is a pixel and silicon strip tracker, followed by the electromagnetic and hadronic calorimeter. Outside of the magnet there is a part of hadronic calorimeter an steel return yoke with embedded muon chambers. The CMS detector layout is shown in Fig.~\ref{fig:figures/cmsdetector}. In the following sections, the layers of the CMS, starting with the innermost, are introduced in more details.
%-coverage up to |eta|<5


    \insertFigure{figures/cmsdetector} % Filename = label
                 {0.9}       % Width, in fraction of the whole page width
                 { A schematic layout of the CMS detector~\cite{website:CMSdet}. }

\subsection{Coordinate system and conventions}

    \insertFigure{figures/coordinates} % Filename = label
                 {0.6}       % Width, in fraction of the whole page width
                 { The CMS coordinate system with the three axes intercepting at interaction point, x-axis pointing inside the LHC ring, y-axis going upwards and z-axis pointing anti-clockwise in the direction of the beam.~\cite{Pantaleo:2293435}. }

The coordinate system used by CMS is sketched in Fig.~\ref{fig:figures/coordinates}. In the CMS conventions, the Cartesian coordinate system has a center at interaction point, with x-axis is pointing into the center of the LHC, y-axis is going upwards and z-axis is going anti-clockwise in the beam direction. The azimuthal angle $\Phi$ is defined in the x-y plane and is measured from the x-axis. The polar angle $\Theta$ is measured from the z-axis and is defined in x-z plane. Finally the $r$ is a radial coordinate in x-y plane. In this convention the pseudorapidity $\eta$ is defined as

\eq{pseudorapidity}
{
    \eta =  -\ln \left[ \tan \left( \frac{\Theta}{2} \right) \right].
}

The distance of two points can be measured with help of $\Delta R$ defined as

\eq{deltaR}
{
    \Delta R = \sqrt{ \Delta \Phi^2 + \Delta \eta^2}.
}


The transverse momentum $p_{T}$ can be computed from the x and y momentum components as

\eq{pseudorapidity}
{
    p_{T} =  \sqrt{p_{x}^2 + p_y^2 }.
}


\subsection{Solenoid}


The CMS magnet is superconducting solenoid providing magnetic field of 3.8~T. The magnet is surrounded from outside by the steel yoke which returns the magnetic flux of the solenoid~\cite{tdrMagnet}. Because of the physics reasons, the radius of the magnet has to be small and therefore the available space between the magnet and interaction point is limited.

\subsection{Silicon tracker}

The silicon tracker~\cite{CMS:1997tlf, CMS:2000eqx} is the innermost subdetector of the CMS detector. The CMS tracker can be divided into two parts. The inner part consist pixel detectors, while the outer part by strip detectors. The whole tracker is composed of the modules with silicon sensors, aiming to measure path of the track. Its purposed is to reconstruct tracks from charged particles' depositions in silicon sensors along their path and the primary and secondary vertices. The track is the reconstructed path of the particle passing trough the tracker. The primary vertices, which are vertices from the interaction of interest and PU interactions, are the positions of the interaction and can be determined using the tracks. The secondary vertices are the places where given particle decayed to other particles. They are also found with help of the tracks. As the tracker is in the magnetic field, paths of charged particles are bent according to their momenta and charge, thus the CMS tracker is able measured charge sign and momenta as well. To perform so, the tracker has to have good spatial resolution and to be extremely radiation-hard due to large flux of incoming particles. Also the material has to be chosen carefully, in order to avoid multiple scattering, nuclear interactions or bremsstrahlung in the tracker material.

The density of the particles in the CMS detector decrease with the distance from the interaction point and therefore the inner part of the tracker is made of silicon pixels, which are able to measure particle paths and its properties in high particle density environment. In the outer part of the tracker, the particle density is low enough to use silicon strip sensors, which are cheaper mainly because they require less readout channels. Overall, the tracker pseudorapidity coverage is  $\eta < 2.5$.

\subsubsection{Silicon strip tracker}

In the following chapters studies of the silicon strip tracker and its simulation are presented and thus it is necessary to take a deeper look into its design. The silicon strip tracker is divided into four partitions. Each of the partition has layers of modules, which have either one side~(mono) or two sides~(stereo) of silicon sensors. The tracker inner barrel~(TIB) is the innermost barrel part with two layers of stereo modules succeeded with two layers of mono modules. The tracker outer barrel~(TOB) surrounds the TIB. In the innermost part of TOB, there are two layers of stereo modules, the remaining four layers are mono. On each side of the barrels, tracker inner disks~(TID) and tracker endcaps~(TEC) are located. There are three wheels of TID with three module rings and 9 wheels of TEC with four to seven rings of modules on each side. In each layer there is a mixture of mono and stereo modules, but each ring has either mono or stereo modules. The overall layout of the silicon strip tracker can be seen in Fig.~\ref{fig:figures/cmsTracker}.

    \insertFigure{figures/cmsTracker}
                 {0.9}       
                 {A schema of the upper half of the CMS silicon strip tracker and layout of its partitions. The modules in blue are stereo, while the mono ones are shown in black color~\cite{Chatrchyan:2014fea}. }

Each mono module holds 320$\mathrm{\mu m}$ or 500$\mathrm{\mu m}$ thick silicon sensors with either 512 or 768 silicon strips. In case of stereo modules the number of strips doubles. The strip length is between 8 and 25~cm and its width is 18~$\mathrm{\mu m}$. The distance between strips, called pitch, varies between 80 $\mu m$ and 200 $\mu m$. In barrels the strips are parallel to the z-axis, or are tilted by 100~mrad with respect to the z-axis. In the disks and endcaps, the strips are aligned to be parallel to $r$. The local module coordinates have zero in the middle of the module, z-axis goes in direction from back-plane to strips, y-axis goes along strips, and x-axis is perpendicular to the strips and traverses them. The local $\Theta$ angle is measured from the z-axis and the local $\Phi$ is defined in xy-plane and is measured from the x-axis. The details about the module geometries for each layer of TIB and TOB and each ring of TID and TEC can be found in Tab.~\ref{tab:trackerGeometries}.

%TODO local module geometry

\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
Layer & Type  & Strips & Thickness~[$\mathrm{\mu m}$] & Pitch~[$\mathrm{\mu m}$]  \\
\hline
\hline
TIB L1 & stereo & 768 & 320 & 80  \\
TIB L2 & stereo & 768 & 320 & 80  \\
TIB L3 & mono & 512 & 320 & 120  \\
TIB L4 & mono & 512 & 320 & 120 \\
\hline
TOB L1 & stereo & 768/512 & 500 & 122/183 \\
TOB L2 & stereo & 768/512 & 500 & 122/183 \\
TOB L3 & mono & 512 & 500 & 183 \\
TOB L4 & mono & 512 & 500 & 183 \\
TOB L5 & mono & 768 & 500 & 122 \\
TOB L6 & mono & 768 & 500 & 122 \\
\hline
TID R1 & stereo & 768 & 320 & 81...112  \\
TID R2 & stereo & 768 & 320 & 113...143  \\
TID R3 & mono & 512 & 320 & 124...158  \\
\hline
TEC R1 & stereo & 768 & 320 & 81...112  \\
TEC R2 & stereo & 768 & 320 & 113...143  \\
TEC R3 & mono & 512 & 320 & 124...158  \\
TEC R4 & mono & 512 & 320 & 113...139  \\
TEC R5 & stereo & 768 & 500 & 126...156  \\
TEC R6 & mono & 512 & 500 & 163...205  \\
TEC R7 & mono & 512 & 500 & 140...172  \\
\hline
\end{tabular}
\caption[Table caption text]{The module type, number of strips, thickness and pitch for layers or rings of four silicon strip tracker partitions~\cite{website:hephyPage}. }
\label{tab:trackerGeometries}
\end{center}
\end{table}

\subsection{Electormagnetic calorimeter}

The electromagnetic calorimeter (ECAL)~\cite{tdrECAL} is a subdetector following the silicon tracker. It is homogeneous, fast, radiation resistant calorimeter with a good energy resolution. It is composed of lead-tungstate ($\mathrm{PbWo_{4}}$) crystals and its purpose is to measure energy of electrons and photons. The ECAL consist of two parts, barrel~(EB) covering $|\eta|<1.479$ and endcaps~(EC) extending the coverage up to $\eta =3$. A preshower is placed in front of the endcaps in order to separate highly energetic single photons from the photons originating from the decay of neutral pions.

The energy resolution of ECAL was determined to be

\eq{ECALresol}
{
 \frac{\sigma_{E}}{E} = \frac{0.028}{\sqrt{E}} \bigoplus \frac{0.12}{E} \bigoplus 0.003 ,
}

where $E$ is energy and $\sigma_{E}$ is energy resolution. The first term is stochastic part, it corresponds to e.g. fluctuations in number of particles. The second term accounts for noise and the third term covers mainly the non-uniformities, energy leakage and inter-calibration issues.


\subsection{Hadron calorimeter}

The purpose of the hadron calorimeter~(HCAL)~\cite{tdrHCAL}, which is another subdetector of the CMS, is to measure energy of strongly interacting particles.  The HCAL is a sampling calorimeter composed of four parts, out of them two are located between the ECAL and magnet, which are HCAL barrel~(HB) and endcaps~(HE). Both HE and HB have a brass absorber and their active material is made of plastic scintillator. The pseudorapidity coverage of HB is $|\eta|<1.3$, and of HE $1.3<|\eta|<3$. The coverage is further extended up to $|\eta|=5.2$ by the third part called forward calorimeter~(HF). The HF, installed 11.2 meters far from the interaction point on both sides, is made of steel serving as an absorber and quartz fibers creating an active volume. The technology of the HF is very radiation-hard as around third of particles produced in the final state reaches the HF. Because of the available space between the ECAL and magnet was not large enough to build calorimeter with enough of stopping power, the last part of the calorimeter, the outside calorimeter~(HO), was added after the magnet. The HO is covering region $|\eta|<1.3$ and stops particles escaping the HB, for this reason it is sometimes also referred as ``tail catcher''. The magnet material is used as an absorber for HO.

The hadron energy resolution from combination of ECAL and HCAL (barrel and endcaps)~\cite{Chatrchyan:2009ag} was determined to be


\eq{HCALresol}
{
 \frac{\sigma_{E}}{E} = \frac{0.847}{\sqrt{E}} \bigoplus 0.074 ,
}

where the meaning of the terms is similar as for the ECAL.
%- for HF 1.98/sqrt(E)+0.09 -> higher because of high energy of jets in this region but as divided by energy, it is ok

\subsection{Muon chambers}

Because many interesting physics processes have signature with muons in the final state, good and precise measurement of muons is one of the main goals of the CMS. This comprises muon identification, momentum measurement and triggering. The good triggering and momentum measurement is achieved with help of the high magnetic field provided by the solenoid. The measurement of muons is provided by three gaseous subdetectors, the Drift Tube~(DT), Cathode Strip Chamber~(CSC) and Resistive Plate Chamber~(RPC) systems~\cite{tdrMuon}.

The DTs are located in the barrel region and they are partly integrated into the return yoke.  The pseudorapidity coverage is of $|\eta|<1.2$. They are composed of plane cathodes with anode wires in between the planes. The CSCs are in the endcap areas and are located outside of the return yoke. The CSCs coverage is $0.9<|\eta|<2.4$, which is partly overlapping with the DTs. The CSCs also contain cathodes with anode wires in between, but one cathode of the pair is segmented into strips. The DTs and CSCs provide good triggering on muons which independent of the rest of the CMS.

To ensure the triggering on the right bunch crossing, the complementary RPCs are present in both barrel and endcap regions. The RPCs are faster DTs and CSCs, but on the other hand they provide worse position resolution. The RPCs trigger is independent of the CSCs and DTs. They are composed of parallel plates of anodes and cathodes and readout strips. 

In the following sub-section the time measurement in DTs is introduced. The timing can be also measured with CSCs and ECAL in very similar way, but for the purposes of the thesis, only knowledge of the time measurement in DTs is needed.

\subsubsection{Muon timing measurement in DTs}

The muon going through DTs deposits its energy by ionization of the gas. Created charge carriers drift towards the wires and are read at time $t_{read}$. If it is assumed that the muon was produced in-time with collision and its speed is speed-of-light, the time ($t_{cell}$) when the muon arrives from the interaction point to the given drift cell can be calculated then. With the knowledge of the drift velocity~$v_{drift}$, the difference between $t_{read}$ and $t_{cell}$ can be converted into distance as shown in Fig.~\ref{fig:figures/dtTiming}. In this figure the distance $ v_{drift} (t_{read} - t_{cell})$ is illustrated in violet arrow. The distance is then used to compute the hit positions where muon crossed the cells, starting from the wire as shown in blue crosses. In case that the production time was assumed correctly, all hits should be on one line. If the particle was not produced ``in-time'' with the assumed production time, the hits are be shifted~(red crosses) and the line which connects them is not straight, but curly. The distance between reconstructed hits and hits on the straight line is converted to the time~$\delta t$, which measures real arrival time of muon with respect to the expected arrival time, and thus can be used to compute the muon timing~\cite{Traczyk:1365029}.


    \insertFigure{figures/dtTiming} % Filename = label
                 {0.5}       % Width, in fraction of the whole page width
                 { A schema of few drift cells of DTs. The wires are shown in black dots, the drift direction in purple arrows, the expected hits in blue crosses and the reconstructed hits in the red crosses. The distance between reconstructed and expected hits is converted to time and denoted as $\delta t$~\cite{Traczyk:1365029}. }

The timing measurements are combined to produce, among others, the following variables: 

\begin{description}
\item [TimeAtIPInOut]
This variable corresponds to the time at which muon was present the interaction point, assuming that muon moves at speed of light from the IP outside of the CMS. It is computed as a weighted average of measured $\delta t$ values, where in case of the DTs each weight weight is equal to N-2, with N being a number of hits in a segment of DTs to which the the hit belongs. The error on the time measurement is computed as

\eq{timingResol}
{
 \sigma^{2} = \frac{1}{N-1} \times \frac{1}{\sum{w_{i}}} \times \sum{(t_i-\bar{t})^2 w_{i} },
}

where wight $w_{i}$ is defined as $w_i = 1/\sigma_{i}^2$ with $\sigma_{i}$ being a single hit resolution, $\bar{t}$ is the weighted average of the $\delta t$ measurements.

\item[TimeAtIPOutIn]
The TimeAtIPOutIn is the muon time at interaction point assuming that a muon moving from outside of the CMS detector towards the IP. During the calculation, each $\delta t$ measurement is increased by twice time-of-flight~(TOF) of the in-time muon from IP to the DT cell measuring the $\delta t$. Then the procedure continues as for the TimeAtIPInOut.

\item[Direction]
The direction variable provides a simple and robust estimate if the muon traveled from the IP out or opposite. The evaluation takes into account the errors on the TimeAtIPOutIn and TimeAtIPInOut variables and assumes that the correct time hypothesis has smaller error.

\item[Free inverse beta]
This variable is free $c/v$, where $c$ is the speed of light and $v$ speed of the muon. The word ``free''indicates that neither particle production time, direction nor velocity is assumed and these are free parameters. It is obtained from the fit of muon time-of-flight measurements.

The timing resolution for DTs in Run~I was determined to be 7-9~ns~\cite{Traczyk:1365029}, compared to 2.3~ns obtained from simulation. The measured resolution is expected to decrease as the detector synchronization improves.

\end{description}
%-on top of it
 %CMS being synchronized "top-down" for cosmic runs, so that a cosmic muon going vertically down is always in-time (or "at the same time" to be more precise). So basically the DT system is timed for muons going straight down. (just like for collisions it's timed for muons going outwards from IP).In practical terms. The "muons" collection takes as timeAtIpInOut what is more or less the mean of the segment times for a muon. Because it's assuming that the muon is propagating in the same direction that the system is synchronized in. From my observations above it looks like this is the case, the system is synchronized for downward-going cosmics. - not the case in the paper

\subsection{Trigger and data acquisition}

As bunches are colliding every 25~ns, thus with a rate of 40~MHz, a good, fast and reliable triggering system is required. The data size of one event is approximately 1~MB, therefore if there would not be any dedicated trigger, 40~TB of data per second would have to be stored, what is far beyond current technical capacities. In the CMS there are two level of triggers which provide physics motivated selection of the interesting events. The first one called Level-1~(L1), is hardware based and its decision-making is based in information from muon chambers and calorimeters. The L1 is capable to decide within 3.4~$\mu s$ and its output rate is around 100~kHz. The rest of the event is read upon the decision of L1 and sent to the second level called High Level Trigger~(HLT). The HLT is software based trigger providing further selection. The output rate from HLT is of other of hundreds of Hz. The time period of uninterrupted data-taking is called a run. For example, the run can be interrupted because of the detector techincal difficulties, or switching between collision and cosmics data-taking.

\subsection{Luminosity and pile-up}

In the particle physics experiments it is very important to have information about an expected event rate during a time period. For this evaluation, following formula can be used

\eq{nev}
{
 \frac{\mathrm{d}N}{\mathrm{d}t} = \sigma \times \mathcal{L},
}

where $\sigma$ is the cross section of process of interest and $\mathcal{L}$ is the instantaneous luminosity given by

\eq{luminosity}
{
 \mathcal{L} = \frac{N_{p}^2 N_{b} f_{rev} \gamma}{4 \pi \epsilon_{n} \beta^{*}}F,
}

where the variables in numerator are $N_{p}$ which is the number of particle in one bunch, $N_{b}$ which is the number of bunches in one beam and $f_{rev}$ which is the revolution frequency and $\gamma$ is the relativistic gamma factor. In the denominator the $\epsilon_{n}$ is normalized transverse beam emittance and $\beta_{*}$ is the beam amplitude function. Lastly, because of the beam crossing angle the reduction factor $F$ is introduced.

By integration of the instantaneous luminosity over time, the integrated luminosity can be obtained:

\eq{intluminosity}
{
 L = \int{ \mathcal{L} \mathrm{d}t}.
}

The LHC was designed to deliver the instantaneous luminosity of $1 \times 10^{34} \mathrm{cm^{-2}s^{-1}}$. At the beginning of Run~I the instantaneous luminosity was lower than the designed one and it has been increased during the years of LHC operation. Later, because of the smooth running, it was decided to go even beyond the designed luminosity, up to $1.58 \times 10^{34} \mathrm{cm^{-2}s^{-1}}$~\cite{Pralavorio:2272474}. The integrated luminosity delivered to CMS over years 2010-2017 can be seen in Fig~\ref{fig:figures/cmslumi}.

    \insertFigure{figures/cmslumi} % Filename = label
                 {0.6}       % Width, in fraction of the whole page width
                 { The delivered luminosity to the CMS detector for years 2010-2017~\cite{website:CMSlumi}. }


High luminosity is essential to study rare processes, but on the other hand it brings effect called pile-up~(PU)~\cite{Bayatian:2006nff}. Pile-up particles are particles which are not originating from the interaction of interest. Further, pile-up can be divided into two categories. During one bunch crossing, not only the interaction of interest is produced, but more inelastic or diffractive interactions appear at the same time. This kind of pile-up is referred as in-time pile-up. The second kind of pile-up is called out-of-time pile-up~(OOT PU) and originates from particles produced before or after the bunch crossing of interest. The OOT PU is caused for example by slow particles looping in the detector.

\newpage

\section{Event and object reconstruction at CMS~\label{sec:objects}}

The events triggered by the HLT are saved in the RAW format, but they are also processed in order to reconstruct objects. The output of such reconstruction is saved in RECO format. Most physics analyses do not need all the information present in the RECO files, and thus these files are slimmed up to a miniAOD~\cite{Petrucciani:2029414} format in order to save space and computing time (later in the Run~II the miniAOD was slimmed the nanoAOD format). In this section several physics objects, which are important for the analyses discussed in this thesis, are introduced.


\subsection{Particle-Flow algorithm}

As it can be seen in Fig.~\ref{fig:figures/CMStransverse} each kind of particle leaves characteristic signature in the CMS detector. For example, an electron leaves track in the tracker and then stops in the ECAL where it deposits its rest of its energy. The neutral hadron does not interact in the tracker but it leaves energy both in ECAL and then HCAL where it stops.

    \insertFigure{figures/CMStransverse} % Filename = label
                 {0.9}       % Width, in fraction of the whole page width
                 { Transverse view through the CMS detector. The depositions of different particles in different subdetectors are indicated in the picture~\cite{Sirunyan:2017ulk}. }

The CMS approach to reconstruction of an event takes this into account and combines information from all subdetectors at once to reconstruct the objects. The algorithm used for this kind of reconstruction is called Particle Flow~(PF) algorithm~\cite{Sirunyan:2017ulk}. In general, the deposits left by particle in different subdetectors are connected by the geometrical constraints.

\subsection{Jets and b-jets}

Jets, which are objects originating from hadronization of quarks, are clustered with an $\mathrm{anti-}k_{T}$ clustering algorithm~\cite{Cacciari:2008gp}. The $\mathrm{anti-}k_{T}$ algorithm clusters objects which are reconstructed by the PF algorithm~(PF jets), but differently reconstructed objects can be used as well. Within this algorithm the distance between objects is defined as

\eq{antikt}
{   
    d_{ij} = \mathrm{min}(p_{T}^{-2}(i), (p_{T}^{-2}(j)) \frac{(\eta_{i} -\eta_{j}^2)+ (\Phi_{i} -\Phi_{j}^2)}{R^2} =  \mathrm{min}(p_{T}^{-2}(i), (p_{T}^{-2}(j)) \frac{\Delta R_{ij}^{2}}{R^2}.
}

where $p_{T}$ is the transverse momentum, $\eta$ is the pseudorapidity and $\phi$ is the azimuthal angle of an object. The parameter $R$ is a jet radius parameter and in standard jet reconstruction of Run~II its value is set to 0.4. In case of boosted objects decaying to partons, two or more jets originating from these partons can be merged. These topologies can be reconstructed as so called ``fat jets'', and for purpose of their reconstruction, the parameter $R$ is increased to 0.8 or 1.0. The $\mathrm{anti-}k_{T}$ algorithm, by definition, clusters first the hard objects with shortest distance between each other and continues with objects further apart. The clustering stops when no hard enough particle is nearby. The product of the clustering is a jet.

The measured jet energy does not in general correspond to the energy of parton responsible for the jet, because of several inefficiencies and biases in the energy measurement. Therefore the jet energy must be corrected for such effects.

\subsubsection{b-jets}

In order to know from which parton the jet is originating, the flavor tagging techniques were developed. The heavy flavor tagging techniques target is to recognize jets originating from b quark~(b-jets) or c quark~(c-jets). In further text, only b-jets are discussed. The b-quarks are forming B-mesons, which are decaying within about 1.5 ns creating secondary vertex displaced by few mm up to cm from the primary vertex. Presence of the displaced secondary vertex in the jet, information about particles originating from the secondary vertex and optionally other information is used by b-tagging algorithms to tag jets formed from the b-quarks~\cite{Sirunyan:2017ezt}.

There are several algorithms, which purpose is to tag a b-jet. The first one is the Combined Secondary Vertex~(CSVv2) algorithm, which combines information about displaced tracks with information on the secondary vertex. The DeepCSV algorithm improves CSVv2 algorithm by using deep neural network. The Combined Multivariate Analysis~(cMVAv2) technique takes into account a fact, that hadrons can decay leptonically and thus soft electrons or muons can be present in the b-jet. In this algorithm, the information about soft leptons is used in combination with other taggers.

The performance of b-jet taggers is different in data and event simulations therefore a multiplicative data-to-simulation factor must be used on top of the simulation in order to compensate for the differences.

\subsection{Leptons}

\subsubsection{Muon}

Muons are traversing whole CMS detector and therefore their tracks can be reconstructed in both silicon tracker and muon chambers. The ``standalone muon'' is a muon track reconstructed from the hits in CSC, DT and RPC, while the ``inner track'' muon is reconstructed from the hits in the silicon strip tracker only. There are two options how to reconstruct muon using both information from the muon chambers and the tracker. The first one leads to collection of muons called ``tracker muons''.  The tracker muons are first reconstructed in the tracker and then they are extrapolated to the muon chambers by matching the inner track with hits in the muon chambers. The second approach matches standalone muons with inner track based on geometrical criteria. The resulting collection is called ``global muons''~\cite{Chatrchyan:2012xi}. 

The PF algorithm uses both global and tracker muons to identify a PF muon. As leptons from hard scattering are expected not to have other activity in the proximity, the requirement on muon isolation is added in order to select muon candidate and reject hadrons misidentified as muons. The selected muons are then tested by several quality requirements to balance the efficiency and purity of the muon selection. Based on passing or failing the criteria, several muon IDs are assessed, e.g. loose, medium, tight. 

\subsubsection{Electron}

The electrons are reconstructed with the track information from the tracker and the energy deposits in the ECAL~\cite{Khachatryan:2015hwa}. Because of the bremsstrahlung, the electron looses around 30\% of its energy before reaching the ECAL. The energy deposits in the ECAL are reconstructed as superclusters, taking into account the bremsstrahlung photons. The tracks in the tracker are reconstructed starting either from seed created by few tracker hits or ECAL supercluster and then the track is extrapolated from seeds to the full tracker. In case of tracker-based seeding, the next step is matching ECAL supercluster with the electron track. Similarly as for the muon, the electron isolation is expected as well as quality requirements on the reconstructed electrons are imposed resulting in several categories of electron IDs e.g. loose, medium, tight.

\subsubsection{Tau}

In majority of cases the tau leptons are decaying hadronically to the mixture of charged and neutral hadrons and tau neutrino. The decay is very fast and thus it is difficult to reconstruct the secondary vertex. The algorithm which is used to recognize the hadronically decaying tau is called Hadron-Plus-Strips~(HPS)~\cite{CMS:2016gvn}. This algorithm searches for the neutral pions present in the majority of hadronic tau decays. The neutral pion originating from tau is  decaying to photon pair, which is later converted to electron/positron pairs. These electrons/positrons bend in the magnetic field and thus broaden the energy deposits in the ECAL in azimuthal direction beyond the size of reconstructed hadronic tau jet. To take this affect into account, the electromagnetic particles  are reconstructed into ``strips''. The strip is first associated with the most energetic electron or photon within the PF jet. Then the algorithm looks nearby whether other electromagnetic particles are present close to the selected one. If more energetic electromagnetic particle than the one associated with given strip is found, the strip is associated with this new particle and algorithm proceeds up to the point, when no other more energetic particle is present in the proximity of the strip. The final algorithm searches for the hadronic taus in topologies with single hadron, one hadron and one strip, one hadron and two strips and three hadrons.

\subsection{Missing transverse energy}


If momenta of all particles would be measured, the sum of all momenta in the plane transverse to the beam would be zero. But as neutrinos escape the detector unmeasured, the imbalance of the momenta in this plane is observed. 

The Missing Transverse Energy~($E_{T}^{miss}$ or MET) is magnitude of negative vectorial sum of the transverse momenta of all PF particles~\cite{CMS:2016ljj}. Because of the energy thresholds in the calorimeters, inefficiencies in the tracker or non-linearity of calorimeters' response for hadrons, the MET measurement can be biased and thus the energy correction factor must be used. This factor accounts for effects influencing the MET and is applied on the transverse momenta of the jets. The MET is then recomputed with the new transverse momenta of jets. The uncertainty on MET is evaluated by varying $p_{T}$ of each kind of object within its resolution. 

The MET variable plays crucial role in searches for the physics beyond the Standard Model, as many theories predict stable weekly interacting particles which would enhance the MET.
